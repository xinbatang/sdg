# searchDrawingDog（搜图狗） 使用说明书

## 项目简介

**searchDrawingDog** 是为石油天然气行业 Piping Supervisor 量身打造的智能图纸搜索、版本校对与合并导出工具。  
它极大简化了试压包下发与现场施工前的图纸比对流程，让你一键获得**最新的 ISO（单线图）和 Welding Map（细化图）**，自动判断版本一致性，并支持批量合并、导出和打印，大幅节省人力、避免返工风险。

---

## 核心功能

- **批量查找最新图纸**  
  输入多个管线号，一键搜索指定文件夹下的所有最新 ISO 和 Welding Map。

- **自动判断版本一致性**  
  自动比对 ISO 与 WM 的主版本号，结果以“匹配”、“不一致”、“缺失”高亮显示。

- **合并导出**  
  支持将一组或多组图纸合并为单一 PDF，方便批量打印归档。

- **版本识别灵活**  
  智能识别行业常见的图纸命名方式（含修订号、无修订号、下划线修订、负数版本等）。

- **批量数据可视化**  
  分页显示大量管线，异常结果置顶、着色，一目了然。

- **结果表格可交互**  
  点击文件名直接打开本地 PDF。

- **自适应中英文操作系统**  
  支持 Windows 环境下中文与英文路径、特殊字符。

---

## 软件最大特色

> **为 Piping Supervisor 大幅节省时间！**  
> 解决了“试压包包含大量图纸时，人工比对版本、查找最新图纸”这类高强度重复性工作，实现自动化处理，避免返工与错漏，提升现场管理效率。

---

## 解决的问题

根据以往经验，在下发试压包时，如果包含二三十张图纸，Piping Supervisor 往往需要一一比对每张 ISO 与对应 WM 的版本，确保一致并打印最新图纸。  
**searchDrawingDog** 自动替你搜索、筛选、比对，支持批量合并导出，大大提升现场准备效率，减少人为失误。

---

## 使用说明

1. **输入管线号**  
   在输入框批量粘贴或录入多个管线号（可回车分行）。

2. **选择 ISO 和 WM 目录**  
   分别选择本地存放 ISO（单线图）与 WM（细化图）PDF 的文件夹。

3. **点击“一键查询”**  
   自动搜索所有最新版本的图纸，结果以表格高亮显示，并支持分页浏览。

4. **合并导出/打印**  
   选中所需文件，一键合并导出 PDF，便于批量打印。

5. **表格交互**  
   - 点击文件名可直接打开 PDF 文件

---

## 运行环境

- **操作系统**：仅支持 Windows 10/11
- **依赖工具**：Everything CLI（内置，需运行 Everything 服务）
- **推荐使用方式**：使用打包后的 EXE 文件，解压即用，无需安装 Python 环境

---

## 注意事项（强烈建议阅读！）

### Everything 必须后台运行且权限一致

- **必须提前启动 Everything**（不建议管理员权限）
- **Everything 进程用户需与本程序一致**（即同一 Windows 用户启动，否则无法搜索）
- 若启动软件后报错“Everything进程用户与本程序用户不一致，可能导致 CLI 搜索失败”，请关闭全部 Everything，再用当前登录用户启动 Everything.exe
- 建议右下角托盘确认 Everything 已经在后台运行

### 文件命名要求

- 支持常见如 `_01A`, `Rev01A`, `-0`, `_1A_RL` 等版本后缀
- 文件后缀名大小写敏感，推荐全部为 `.pdf`（系统已自动兼容 `.PDF` 等）



## 常见问题（FAQ）

**Q: 为什么提示“Everything进程用户与本程序用户不一致”？**  
A: *不要用右键管理员身份启动 Everything，双击启动Everything；在任务管理器中有两个Everything进程，这会导致程序启动失败，需要手动关闭系统的Everything，留下当前用户的Everything进程*。

**Q: 为什么某些 PDF 文件无法打开？**  
A: 可能由于文件名大小写（`.PDF`/`.pdf`）、文件被占用、权限问题等。建议统一命名后缀并检查文件是否损坏。

**Q: 合并导出功能出错怎么办？**  
A: 检查所有待合并文件均为合法 PDF。损坏或加密文件暂不支持合并。


---

## 致谢

本软件参考了油气行业一线 Supervisor 的实际操作痛点，由 AI 辅助开发，实现工业现场真正实用的“自动化图纸管家”。  
感谢所有提出建议的朋友，以及 Everything、PyPDF、Tkinter 等开源工具的支持。

---

## 联系与反馈

如有建议、BUG 或业务合作意向，请联系作者（详见项目主页或文档）。

---

**searchDrawingDog，让你的图纸管理再无烦恼！**

---
